import{a as A}from"./chunk-QYSFVW6Z.js";import{a as B}from"./chunk-CE4BNKUB.js";import{a as D,b as j,d as H,f as O,g as P}from"./chunk-BNBULCHM.js";import{Aa as V,B as d,Ba as w,H as f,I as h,M as C,Q as s,R as S,Va as q,ba as l,ga as F,ha as M,ia as U,ja as a,ka as c,la as Q,oa as v,qa as u,ra as T,sa as g,ta as x,ua as _,va as k,wa as m,xa as I,ya as p,za as R}from"./chunk-KJDUKPVH.js";var $=["modal"],L=(()=>{let i=class i{constructor(){this.nextEvent=new C}open(n,e,t){this.success=n,this.message=e,this.score=t,this.modal.nativeElement.showModal()}close(){this.nextEvent.emit(),this.modal.nativeElement.close()}escPress(n){n.preventDefault()}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=d({type:i,selectors:[["app-question-result"]],viewQuery:function(e,t){if(e&1&&g($,7),e&2){let r;x(r=_())&&(t.modal=r.first)}},hostBindings:function(e,t){e&1&&u("keydown.escape",function(b){return t.escPress(b)})},outputs:{nextEvent:"nextEvent"},standalone:!0,features:[V([],[D({heroFaceSmile:P,heroFaceFrown:O,heroArrowRight:H})]),w],decls:11,vars:4,consts:[["modal",""],["id","resultModal",1,"modal","outline-none"],[1,"modal-box","flex","flex-col","items-center","text-center"],["size","140",3,"name"],[1,"text-2xl","text-center","font-bold"],[1,"text-center","mt-4"],["type","button",1,"btn","btn-primary","w-full","mt-4",3,"click","disabled"],["size","14","name","heroArrowRight"]],template:function(e,t){if(e&1){let r=v();a(0,"dialog",1,0)(2,"div",2),Q(3,"ng-icon",3),a(4,"strong",4),m(5),c(),a(6,"span",5),m(7),c(),a(8,"button",6),u("click",function(){return f(r),h(t.close())}),Q(9,"ng-icon",7),m(10," Next question "),c()()()}if(e&2){let r=k(1);s(3),l("name",t.success?"heroFaceSmile":"heroFaceFrown"),s(2),I(t.message),s(2),p("+ ",t.score," points"),s(),l("disabled",!r.open)}},dependencies:[j]});let o=i;return o})();var N=(()=>{let i=class i{constructor(){this.time=0,this.maxTime=A.maxQuestionTime,this.timeIsUp=new C}start(){this.time=this.maxTime,this.countdown=window.setInterval(()=>{this.time-=.01,this.time<=0&&this.endCountdown()},10)}stop(){clearInterval(this.countdown),this.time=this.time>0?this.getRoundedUpTime():0}getRoundedUpTime(){return Math.ceil(this.time)}endCountdown(){this.stop(),this.timeIsUp.emit()}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=d({type:i,selectors:[["app-countdown"]],outputs:{timeIsUp:"timeIsUp"},standalone:!0,features:[w],decls:4,vars:4,consts:[["for","progress-bar",1,"block","text-center","text-xs","font-bold"],["id","progress-bar",1,"progress","progress-accent","w-56","mt-2",3,"value","max"]],template:function(e,t){e&1&&(a(0,"label",0),m(1),c(),a(2,"progress",1),m(3),c()),e&2&&(s(),p("",t.time.toFixed()," Seconds"),s(),l("value",t.time)("max",t.maxTime),s(),p(" ",t.time,`
`))}});let o=i;return o})();var y=function(o){return o.Correct="Correct answer",o.Incorrect="Incorrect answer",o.TimeIsUp="Time is up",o}(y||{});var G=["countdown"],J=["resultModal"];function K(o,i){if(o&1){let E=v();a(0,"button",8),u("click",function(){let e=f(E).$implicit,t=T();return h(t.checkAnswer(e))}),m(1),c()}if(o&2){let E=i.$implicit,n=T();l("disabled",n.disableActions),s(),p(" ",n.decodeBase64(E)," ")}}var he=(()=>{let i=class i{constructor(n,e){this.router=n,this.gameService=e}ngOnInit(){this.reset()}decodeBase64(n){return window.atob(n)}checkAnswer(n){this.countdown.stop(),this.disableActions=!0;let e=this.current.correct_answer==n,t=e?this.countdown.getRoundedUpTime():0,r=e?y.Correct:y.Incorrect;this.resultModal.open(e,r,t),this.game.scores.push(t)}timeIsUp(){this.disableActions=!0,this.resultModal.open(!1,y.TimeIsUp,0)}next(){if(this.game.scores.length===this.game.questions.length){this.gameService.set(this.game),this.router.navigate(["final-score"],{skipLocationChange:!0});return}this.reset()}reset(){this.current=this.game.questions[this.game.scores.length],this.answers=this.getShuffleAnswers(),this.disableActions=!1,this.countdown.start()}getShuffleAnswers(){let n=[this.current.correct_answer,...this.current.incorrect_answers];for(let e=n.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[n[e],n[t]]=[n[t],n[e]]}return n}};i.\u0275fac=function(e){return new(e||i)(S(q),S(B))},i.\u0275cmp=d({type:i,selectors:[["app-question"]],viewQuery:function(e,t){if(e&1&&(g(G,7),g(J,7)),e&2){let r;x(r=_())&&(t.countdown=r.first),x(r=_())&&(t.resultModal=r.first)}},inputs:{game:"game"},standalone:!0,features:[w],decls:11,vars:3,consts:[["countdown",""],["resultModal",""],[1,"w-128","max-w-full","min-h-screen","mx-auto","flex","flex-col","items-center","justify-center","p-4"],[1,"text-center","text-sm","font-bold"],[1,"mt-6",3,"timeIsUp"],[1,"w-full","font-medium","bg-base-300","mt-6","px-6","py-4","rounded-2xl"],["type","button",1,"btn","btn-primary","w-full","mt-4",3,"disabled"],[3,"nextEvent"],["type","button",1,"btn","btn-primary","w-full","mt-4",3,"click","disabled"]],template:function(e,t){if(e&1){let r=v();a(0,"main",2)(1,"h1",3),m(2),c(),a(3,"app-countdown",4,0),u("timeIsUp",function(){return f(r),h(t.timeIsUp())}),c(),a(5,"p",5),m(6),c(),M(7,K,2,2,"button",6,F),c(),a(9,"app-question-result",7,1),u("nextEvent",function(){return f(r),h(t.next())}),c()}e&2&&(s(2),R("Question ",t.game.scores.length+1," of ",t.game.questions.length,""),s(4),I(t.decodeBase64(t.current.question)),s(),U(t.answers))},dependencies:[L,N]});let o=i;return o})();export{he as default};
